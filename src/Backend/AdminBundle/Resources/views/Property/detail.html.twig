{% extends 'BackendAdminBundle::layout.html.twig' %}

{% block breadcrumb %}
    {{ parent() }}
    <li> <a href="{{ path('backend_admin_property_index') }}">{{ 'label_menu.property'|trans  }}</a> </li>
    <li> <a href="{{ path('backend_admin_property_edit', { 'id': entity.id }) }}">{{ 'label_edit'|trans  }}</a> </li>

{% endblock %}

{% block body -%}
    {{ parent() }}

    <style>
        .fulltable{
            width: 100% !important;
        }
    </style>
        <div class="header">
            <div class="container">
                <div class="row">
                    <div class="col-md-3">
                        <h3 class="header-title">Property Details:</h3>
                    </div>
                    <div class="col-md-7 text-left">
                        <h4>Apartment 101 <span style="font-size:14px;">Floor 1, Weston</span> </h4>
                    </div>
                    <div class="col-md-2">
                        <button type="submit" class="btn btn-primary">Change Tenant</button>
                    </div>
                </div>

                <hr style="border-width: 1px; border-style: dashed; border-color: #93a7b2;"/>

            </div>
        </div>

        <!-- CONTENT -->
        <div class="main-content no-bordertop">
            <div class="container">
                <div class="form-inputs-g">

                    <div class="row color2">
                        <div class="col-md-6">
                            <div class="col-md-3">
                                <p class="txt-blue-bold">Actual Tenant</p>
                            </div>
                            <div class="col-md-1">

                            </div>
                            <div class="col-md-8">
                                <p>Andres Garcia Bernat</p>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="col-md-3 text-right">
                                <p class="txt-blue-bold">Owner</p>
                            </div>
                            <div class="col-md-1">

                            </div>
                            <div class="col-md-8">
                                <p>Andres Garcia Bernat</p>
                            </div>
                        </div>
                    </div>

                    <div class="row color1">
                        <div class="col-md-6">
                            <div class="col-md-4">
                                <p class="txt-blue-bold text-left">Family Members: </p>
                            </div>
                            <div class="col-md-8">
                                <p>4 <br> Omar Alvarez, Monica Solares, Renato Hernandez, Diego Fernandez</p>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="col-md-3 text-right">
                                <p class="txt-blue-bold">Address: </p>
                            </div>
                            <div class="col-md-1">

                            </div>
                            <div class="col-md-8">
                                <p>1234 SW 33186</p>
                            </div>
                        </div>
                    </div>


                    <div class="row color2">
                        <div class="col-md-6">
                            <div class="col-md-3">
                                <p class="txt-blue-bold">Tenant Email:</p>
                            </div>
                            <div class="col-md-1">

                            </div>
                            <div class="col-md-8">
                                <p>andres@gameboard.tech</p>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="col-md-3 text-right">
                                <p class="txt-blue-bold">Owner Email:</p>
                            </div>
                            <div class="col-md-1">

                            </div>
                            <div class="col-md-8">
                                <p>(andres@gameboard.tech</p>
                            </div>
                        </div>
                    </div>

                    <div class="row color1">
                        <div class="col-md-6">
                            <div class="col-md-3">
                                <p class="txt-blue-bold">Tenant Phone:</p>
                            </div>
                            <div class="col-md-1">

                            </div>
                            <div class="col-md-8">
                                <p>(305) 9999-5555</p>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="col-md-3 text-right">
                                <p class="txt-blue-bold">Owner Phone:</p>
                            </div>
                            <div class="col-md-1">

                            </div>
                            <div class="col-md-8">
                                <p>(305) 9999-5555</p>
                            </div>
                        </div>
                    </div>

                    <div class="row color2">
                        <div class="col-md-6">
                            <div class="col-md-3">
                                <p class="txt-blue-bold">Emergency Call:</p>
                            </div>
                            <div class="col-md-1">

                            </div>
                            <div class="col-md-8">
                                <p>Monica Solares - (305) 9999-5555 <br/> Frederick Mora (405) 444-4578 </p>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="col-md-3 text-right">
                                <p class="txt-blue-bold">Emergency Call:</p>
                            </div>
                            <div class="col-md-1">

                            </div>
                            <div class="col-md-8">
                                <p>Monica Solares - (305) 9999-5555 <br/> Frederick Mora (405) 444-4578 </p>
                            </div>
                        </div>
                    </div>


                    <hr style="border-width: 1px; border-style: dashed; border-color: #93a7b2;"/>


                    <div class="row color2">
                        <div class="col-md-6">
                            <div class="col-md-5">
                                <p class="txt-blue-bold text-left">Select Agreement </p>
                            </div>
                            <div class="col-md-7">

                                <select  class="form-control classic" id="exampleFormControlSelect1">
                                    <option>CO1-12.04.18</option>
                                    <option>2</option>
                                    <option>3</option>
                                    <option>4</option>
                                    <option>5</option>
                                </select>


                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="col-md-5">
                                <p class="txt-blue-bold text-right">Who Pays Maintenance: </p>
                            </div>
                            <div class="col-md-7 text-right">
                                <label class="radio-inline"><input type="radio" name="optradio" checked>Owner</label>
                                <label class="radio-inline"><input type="radio" name="optradio" checked>Tenant</label>
                            </div>
                        </div>
                    </div>

                    <div class="row color1">
                        <div class="col-md-6">
                            <div class="col-md-5">
                                <p class="txt-blue-bold">Contract end date: </p>
                            </div>
                            <div class="col-md-7 text-right">
                                12/04/22
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="col-md-5">
                                <p class="txt-blue-bold text-right">Maintenance cost: </p>
                            </div>
                            <div class="col-md-7 text-right">
                                $540 <a href="{{ path('backend_admin_property_update_maintenance', {id: entity.id}) }}"  ><button class="btn_update btn-primary" type="button">Update</button></a>
                            </div>
                        </div>
                    </div>



                    <div class="row color2">
                        <div class="col-md-6">
                            <div class="col-md-5">
                                <p class="txt-blue-bold">Contract start date: </p>
                            </div>
                            <div class="col-md-7 text-right">
                                12/04/22
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="col-md-5">
                                <p class="txt-blue-bold text-right">Contract expires in: </p>
                            </div>
                            <div class="col-md-7 text-right">
                                10 months, 4 weeks, 10 days <a href="{{ path('backend_admin_property_contract_extend', {id: entity.id}) }}"  ><button type="button"  class="btn_update btn-primary">Extend</button></a>&nbsp;&nbsp;<a href="{{ path('backend_admin_property_contract_cancel', {id: entity.id}) }}"  ><button type="submit"  class="btn_cancel btn-primary">Cancel</button></a>
                            </div>
                        </div>
                    </div>
                    <br>

                    <div id="tabs">
                        <ul>
                            <li><a href="#tabs-tickets">Tickets</a></li>
                            <li><a href="#tabs-payments">Payments</a></li>
                            <li><a href="#tabs-booking">Booking</a></li>
                            <li><a href="#tabs-log">Log</a></li>
                        </ul>
                        <div id="tabs-tickets">

                            <!-- widget content -->
                            <div class="widget-body no-padding">

                                <div class="widget-body-toolbar">

                                </div>

                                <table id="ticket_table" class="table table-striped table-hover fulltable">
                                    <tfoot class="dt_tfoot">
                                    <tr>
                                        <th>&nbsp;</th>
                                        {#<th>{{ 'label_complex'|trans }}</th>#}
                                        <th>{{ 'label_title'|trans }}</th>
                                        <th>&nbsp;</th>
                                        <th>{{ 'label_category'|trans }}</th>
                                        <th>&nbsp;</th>
                                        <th>&nbsp;</th>

                                        <th class="pizote-actions">&nbsp;</th>

                                    </tr>
                                    </tfoot>
                                    <thead>
                                    <tr>
                                        {# sorting of properties based on query components #}
                                        <th>ID</th>
                                        {#<th>{{ 'label_complex'|trans }}</th>#}
                                        <th>{{ 'label_title'|trans }}</th>
                                        <th>{{ 'label_type'|trans }}</th>
                                        <th>{{ 'label_category'|trans }}</th>
                                        <th>{{ 'label_status'|trans }}</th>
                                        <th>{{ 'label_time_elapsed'|trans }}</th>


                                        <th class="pizote-actions">{{ 'label_actions'|trans }}</th>
                                    </tr>

                                    </thead>
                                    <tbody></tbody>

                                </table>
                                {# display navigation #}

                            </div>
                            <!-- end widget content -->

                        </div>
                        <div id="tabs-payments">
                            <p>Morbi tincidunt, dui sit amet facilisis feugiat, odio metus gravida ante, ut pharetra massa metus id nunc. Duis scelerisque molestie turpis. Sed fringilla, massa eget luctus malesuada, metus eros molestie lectus, ut tempus eros massa ut dolor. Aenean aliquet fringilla sem. Suspendisse sed ligula in ligula suscipit aliquam. Praesent in eros vestibulum mi adipiscing adipiscing. Morbi facilisis. Curabitur ornare consequat nunc. Aenean vel metus. Ut posuere viverra nulla. Aliquam erat volutpat. Pellentesque convallis. Maecenas feugiat, tellus pellentesque pretium posuere, felis lorem euismod felis, eu ornare leo nisi vel felis. Mauris consectetur tortor et purus.</p>
                        </div>
                        <div id="tabs-booking">

                            <!-- widget content -->
                            <div class="widget-body no-padding">

                                <div class="widget-body-toolbar">
                                    <div class="row">
                                        <div class="col-md-4">
                                            <label>{{ 'label_requested'|trans }} ({{ 'label_dates'|trans }})</label>
                                        </div>
                                        <div class="clearfix"></div>
                                        <div class="input-daterange">
                                            <div class="col-md-4">
                                                <input type="text" name="start_date" id="start_date" class="form-control myDate" />
                                            </div>
                                            <div class="col-md-4">
                                                <input type="text" name="end_date" id="end_date" class="form-control myDate" />
                                            </div>
                                        </div>

                                    </div>
                                </div>
                                <div class="clearfix"></div>
                                <br/>

                                <table  style="width: 100%;" id="booking_table" class="table table-striped table-hover fulltable">
                                    <tfoot class="dt_tfoot">
                                    <tr>
                                        <th>ID</th>
                                        <th>{{ 'label_common_area'|trans }}</th>
                                        <th>{{ 'label_property'|trans }}</th>
                                        <th>{{ 'label_login_user'|trans }}</th>
                                        <th>{{ 'label_status'|trans }}</th>
                                        <th>{{ 'label_event_date'|trans }}</th>
                                        <th>{{ 'label_requested'|trans }}</th>
                                        <th>{{ 'label_approved'|trans }}</th>
                                        {#<th>{{ 'label_complex'|trans }}</th>#}
                                        {#
                                        <th>{{ 'label_hour_from'|trans }}</th>
                                        <th>{{ 'label_hour_to'|trans }}</th>

                                        #}
                                        <th></th>
                                    </tr>
                                    </tfoot>
                                    <thead>
                                    <tr>
                                        {# sorting of properties based on query components #}
                                        <th>ID</th>
                                        <th>{{ 'label_common_area'|trans }}</th>
                                        <th>{{ 'label_property'|trans }}</th>
                                        <th>{{ 'label_login_user'|trans }}</th>
                                        <th>{{ 'label_status'|trans }}</th>
                                        <th>{{ 'label_event_date'|trans }}</th>
                                        <th>{{ 'label_requested'|trans }}</th>
                                        <th>{{ 'label_approved'|trans }}</th>
                                        <th>{{ 'label_actions'|trans }}</th>
                                    </tr>

                                    </thead>
                                    <tbody></tbody>

                                </table>
                                {# display navigation #}

                            </div>
                            <!-- end widget content -->                            
                        </div>
                        <div id="tabs-log">
                            <p>Morbi tincidunt, dui sit amet facilisis feugiat, odio metus gravida ante, ut pharetra massa metus id nunc. Duis scelerisque molestie turpis. Sed fringilla, massa eget luctus malesuada, metus eros molestie lectus, ut tempus eros massa ut dolor. Aenean aliquet fringilla sem. Suspendisse sed ligula in ligula suscipit aliquam. Praesent in eros vestibulum mi adipiscing adipiscing. Morbi facilisis. Curabitur ornare consequat nunc. Aenean vel metus. Ut posuere viverra nulla. Aliquam erat volutpat. Pellentesque convallis. Maecenas feugiat, tellus pellentesque pretium posuere, felis lorem euismod felis, eu ornare leo nisi vel felis. Mauris consectetur tortor et purus.</p>
                        </div>

                    </div>

                </div>
            </div>

        </div>


    {#--- TICKETS ---#}
    <script type="text/javascript">

        var ticketsTable;
        {% set myLocale = app.request.getLocale() %};

        function fetchTickets(){

            ticketsTable  = $('#ticket_table').DataTable({
                "columnDefs": [

                    // These are the column name variables that will be sent to the server
                    { "name": "id",   "targets": 0 },
                    { "name": "title",   "targets": 1 },
                    { "name": "type",   "targets": 2 },
                    { "name": "category",   "targets": 3 },
                    { "name": "status",   "targets": 4 },
                    { "name": "elapsed",   "targets": 5 },
                    { "name": "actions",  "targets": 6 },

                ],
                // Server-side parameters
                "processing": true,
                "serverSide": true,
                // Ajax call
                "ajax": {
                    "url": "{{ path('property_ticket_list_datatables', {property: entity.id}) }}",
                    "type": "POST",
                    //dataType: "html"
                },
                // Classic DataTables parameters
                "paging" : true,
                "info" : true,
                "searching": true,
                "pageLength": 10,
                "order": [[1, 'asc']],
                {% if myLocale == 'es' %}
                "language": {
                    "url": "{{ asset('bundles/pizotearkadmin/js/plugin/datatables/dataTables.spanish.lang') }}"
                }
                {% else %}
                "language": {
                    "infoFiltered": ""
                }
                {% endif %}



            });

        }

        $(document).ready(function(){

            $( function() {
                $( "#tabs" ).tabs();
            } );

            //### TICKETS ###
            // Add a text input to each footer cell
            var pos = 1;
            $('#ticket_table tfoot th').each( function () {
                var title = $(this).text();
                if(pos == 1 || pos == 2 || pos == 4 ){//columna Actions
                    $(this).html( "<input id='input" + pos + "' type='text' class='form-control' style='font-family:Arial, FontAwesome; width:50%'/>" );
                }
                pos ++;
            });


            fetchTickets();

            // Apply the search
            pos = 1;
            ticketsTable.columns().every( function () {
                var that = this;

                $("#input"+pos).on( 'keyup change', function () {
                    if ( that.search() !== this.value )
                    {
                        that.search( this.value ).draw();
                    }
                });
                pos++;
            });


        });

    </script>

    {#--- BOOKING ---#}
    <script type="text/javascript">

        var tableBooking;

        function fetchData(){

            tableBooking  = $('#booking_table').DataTable({
                "columnDefs": [

                    // These are the column name variables that will be sent to the server
                    { "name": "id",   "targets": 0 },
                    { "name": "commonArea",  "targets": 1 },
                    { "name": "property",   "targets": 2 },
                    { "name": "user",  "targets": 3 },
                    { "name": "status",  "targets": 4 },
                    { "name": "eventDate",  "targets": 5 },
                    { "name": "requested",  "targets": 6 },
                    { "name": "approved",  "targets": 7 },
                    { "name": "actions",  "targets": 8 }


                ],
                // Server-side parameters
                "processing": true,
                "serverSide": true,
                // Ajax call
                "ajax": {
                    "url": "{{ path('property_booking_list_datatables', {property: entity.id}) }}",
                    "type": "POST",
                    data   : function( d ) {
                        d.start_date= $('#start_date').val();
                        d.end_date= $('#end_date').val();

                    },
                    //"dataSrc": ""
                    //data: {start_date:$('#start_date').val(), end_date:$('#end_date').val()},
                },
                // Classic DataTables parameters
                "paging" : true,
                "info" : true,
                "searching": true,
                "pageLength": 10,
                "order": [[7, 'asc']]/*ACTIONS*/
            });

        }

        $(document).ready(function(){

            // Add a text input to each footer cell
            var pos = 1;
            $('#booking_table tfoot th').each( function () {
                var title = $(this).text();
                if( pos != 9){//columna fecha y actions
                    $(this).html( "<input id='input" + pos + "' type='text' class='form-control' style='font-family:Arial, FontAwesome; width:100%'/>" );
                }

                pos ++;
            });


            fetchData();

            // Apply the search
            pos = 1;
            tableBooking.columns().every( function () {
                var that = this;

                $("#input"+pos).on( 'keyup change', function () {
                    if ( that.search() !== this.value )
                    {
                        that.search( this.value ).draw();
                    }
                });
                pos++;
            });

            //Apply DATES SEARCH
            /*
            $(".myDate").on( 'keyup change', function () {
                table.search( this.value ).draw();
            });
            */


            ///////SEARCH BETWEEN DATES
            $('.input-daterange').datepicker({
                todayBtn:'linked',
                format: "yyyy-mm-dd",
                autoclose: true
            });

            //fetch_data('no');


            $('.myDate').change(function(){
                var start_date = $('#start_date').val();
                var end_date = $('#end_date').val();
                if(start_date != '' && end_date !='')
                {
                    tableBooking.ajax.reload()

                }
                else
                {
                    alert("Both Date is Required");
                }
            });



        });

    </script>

{% endblock %}

{% block extrascripts %}



{% endblock %}