<style>
    .input-group {
        z-index: 0;
    }
</style>

<div class="row">

    	
	<article class="col-sm-12 col-md-12 col-lg-12 sortable-grid ui-sortable">

		<div data-widget-editbutton="false" data-widget-colorbutton="false" id="wid-id-2" class="jarviswidget jarviswidget-sortable" style="" role="widget">

			<header role="heading">
				<h2>{{ 'label_form'|trans }}</h2>

			</header>

			<!-- widget div-->
			<div role="content">

				<!-- widget edit box -->
				<div class="jarviswidget-editbox">
					<!-- This area used as dropdown edit box -->

				</div>
				<!-- end widget edit box -->

				<!-- widget content -->
				<div class="widget-body">

					
                    {{ form_start(form) }}
                    	

						<fieldset>
							<div id="section_username">
								<div class="form-group col-md-6">
									{{ form_label(form.username) }}
									{{ form_errors(form.username) }}
									{{ form_widget(form.username, { 'attr': {'class' : 'form-control' } }
									) }}
								</div>

							</div>

							<div class="form-group col-md-6">
								{{ form_label(form.name) }}
								{{ form_errors(form.name) }}
								{{ form_widget(form.name, { 'attr': {'class' : 'form-control' } }
								) }}
							</div>
							<div class="clearfix"></div>

							<div class="form-group col-md-6">
								{{ form_label(form.email) }}
								{{ form_errors(form.email) }}
								{{ form_widget(form.email, { 'attr': {'class' : 'form-control' } }
								) }}
							</div>
	                        <div class="form-group col-md-6">
	                            {{ form_label(form.password) }}
	                            {{ form_errors(form.password) }}
	                            {{ form_widget(form.password, { 'attr': {'class' : 'form-control' } }
	                            ) }}
	                        </div>	
							<div class="clearfix"></div>			




							<div class="form-group col-md-6">
								<label for="user_birthdate" class="required">{{ 'label_birthdate'|trans }}</label>
								{% if edit is defined %}

									<input id="form_birthdate" name="user[birthdate]" type="date" class="form-control" value="{{entity.birthdate|date('Y-m-d')}}"/>
								{% else %}
									<input id="form_birthdate" name="user[birthdate]" type="date" class="form-control"/>
								{% endif %}

								{#


								{% if edit is defined %}
									<input readonly="readonly" id="birthdate" name="user[birthdate]" type="text" class="classPicker form-control" value="{{entity.birthdate|date('m-d-Y')}}" data-date-format='mm-dd-yyyy' />
								{% else %}
									<input readonly="readonly" id="birthdate" name="user[birthdate]" type="text" class="classPicker form-control" value="{{'now'|date('m-d-Y')}}" data-date-format='mm-dd-yyyy' />
								{% endif %}
								#}

							</div>

							<div class="clearfix"></div>
							{% if role == "SUPER ADMIN" %}

								<div class="form-group col-md-6">
									{{ form_label(form.business) }}
									{{ form_errors(form.business) }}
									{{ form_widget(form.business, { 'attr': {'class' : 'form-control' } }
									) }}

								</div>

							{% endif %}


							<div class="form-group col-md-6">
	                            {{ form_label(form.role) }}
	                            {{ form_errors(form.role) }}
	                            {{ form_widget(form.role, { 'attr': {'class' : 'form-control' } }
	                            ) }}
								
							</div>

							<div class="clearfix"></div>

							<div class="form-group col-md-6">
								{{ form_label(form.avatarPath) }}
								{{ form_errors(form.avatarPath) }}
								{{ form_widget(form.avatarPath, { 'attr': {'class' : 'form-control' } }
								) }}

							</div>


							<div class="clearfix"></div>

							<div class="form-group col-md-6">
								{{ form_label(form.enabled) }}
								{{ form_errors(form.enabled) }}
								{{ form_widget(form.enabled, { 'attr': {'class' : 'form-control' } }
								) }}

							</div>

	                        <div class="hide">
	                            {{ form_rest(form) }}
	                        </div>

						</fieldset>

						<div class="form-actions">
							<a href="{{ path('backend_admin_user_index') }}" class="btn btn-default"> {{ 'label_cancel'|trans  }} </a>

							<button class="btn btn-primary">
								<i class="fa fa-save"></i>
								{{ 'label_save'|trans  }}
							</button>
						</div>

					<!--</form>-->
					{{ form_end(form) }}					

				</div>
				<!-- end widget content -->

			</div>
			<!-- end widget div -->

		</div>

		<div class="clearfix"></div>

	</article>
</div>

<script language="JavaScript" type="text/javascript">

	$( document ).ready(function() {

		$("#section_username").hide();
		$("[name='user']").validate({
			success: function(error){
				setUsername();
				return true;
			},

		});

		{% if new is defined %}

			$("[name='user']").validate();
			$("#user_password").rules("add", {required:true});
			$("#user_email").rules("add", {required:true, email:true});
			$("#form_birthdate").rules("add", {required:true});

		{% endif %}

		$("#user_avatarPath").rules("add", {required:false});
		
		 $('[name="user"]').on("submit", function(){
		   //Code: Action (like ajax...)
		   if($("[name='user']").valid()){
			   $('#pizote_spinner').show();
			   return true;
					   	
		   }
		   else{
		   	return false;
		   }

		 });
		
	});


	function setUsername(){
		email = $("#fos_user_registration_form_email").val();
		$("#fos_user_registration_form_username").val(email);
	}


	{#
		$(".classPicker").datepicker({
			changeMonth: true,
			changeYear: true,
			showButtonPanel: true,
			//dateFormat: 'yyyy-mm-dd',
			onClose: function(dateText, inst) {
				$(this).datepicker('setDate', new Date(inst.selectedMonth, inst.selectedDay, inst.selectedYear));
			}
		});

	#}


	/*
	$("#checkExistence").change(function() {
  		checkExistence();
	});

	function checkExistence(){
		
		$.ajax({
			type:"POST",
			dataType:"html",
			url:"{{ path('user_check_existence') }}",
			data: { 'user_username': $("#user_username"), 'user_email': $("#user_email") },
			success:function(data){
				console.log("llega!")
			}
		});	 		
	}
*/
</script>