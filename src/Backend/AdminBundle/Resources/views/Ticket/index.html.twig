{% extends 'BackendAdminBundle::layout.html.twig' %}

{% block breadcrumb %}
    {{ parent() }}
    <li> <a href="{{ path('backend_admin_property_index') }}"></a>{{ 'label_menu.property'|trans }} </li>
{% endblock %}

{% block title %}
    {{ 'label_menu.property'|trans }}
{% endblock %}

{% block javascripts %}
    {{ parent() }}

{% endblock %}


{% block body -%}
    {{ parent() }}

    <div class="header">
        <div class="container">
            <div class="row">
                {% if app.user.role.name == "ADMIN" %}

                    <a class="pull-right btn btn-primary btn-lg" href="{{ path('backend_admin_ticket_new') }}">
                        {{ 'label_create_new'|trans }} {{ 'label_ticket'|trans }}
                    </a>

                {% endif %}
            </div>
            <br/>
            <div class="row">
                <div class="col-md-6">
                    <h3 class="header-title">Your Tickets</h3>
                </div>

                {{ include('BackendAdminBundle:Complex:sessionComplex.html.twig') }}
            </div>
            <div class="row">
                <div class="col-md-12">
                    <blockquote>
                        <div class="col-md-11">
                            <p> Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla vulputate quam ut risus ullamcorper convallis. Morbi pellentesque congue elit malesuada pharetra. Suspendisse iaculis interdum elit, et porta ex tempus eget. Ut nec diam dictum, cursus metus euismod, aliquet ante. Quisque a lacus dapibus, semper ante ac, mollis nibh. Integer gravida tellus nec commodo facilisis. Ut ornare ex a dui elementum, quis mollis ante tristique. Sed hendrerit congue neque, non ornare enim. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas.  </p>
                        </div>
                        <div class="col-md-1 text-right">
                            <i style="font-size:80px;" class="fa fa-question-circle" aria-hidden="true"></i>
                        </div>
                    </blockquote>
                </div>
            </div>
        </div>
    </div>

    <div class="jarviswidget jarviswidget-color-darken" id="wid-id-0" data-widget-editbutton="false">

        <!-- widget div-->
        <div>

            <!-- widget edit box -->
            <div class="jarviswidget-editbox">
                <!-- This area used as dropdown edit box -->

            </div>

            <!-- end widget edit box -->

            <!-- widget content -->
            <div class="widget-body no-padding">

                <div class="widget-body-toolbar">

                </div>

                <table id="dt_table" class="table table-striped table-hover">
                    <tfoot class="dt_tfoot">
                    <tr>
                        <th>&nbsp;</th>
                        {#<th>{{ 'label_complex'|trans }}</th>#}
                        <th>{{ 'label_title'|trans }}</th>
                        <th>&nbsp;</th>
                        <th>{{ 'label_category'|trans }}</th>
                        <th>&nbsp;</th>
                        <th>&nbsp;</th>

                        <th class="pizote-actions">&nbsp;</th>

                    </tr>
                    </tfoot>
                    <thead>
                    <tr>
                        {# sorting of properties based on query components #}
                        <th>ID</th>
                        {#<th>{{ 'label_complex'|trans }}</th>#}
                        <th>{{ 'label_title'|trans }}</th>
                        <th>{{ 'label_type'|trans }}</th>
                        <th>{{ 'label_category'|trans }}</th>
                        <th>{{ 'label_status'|trans }}</th>
                        <th>{{ 'label_time_elapsed'|trans }}</th>


                        <th class="pizote-actions">{{ 'label_actions'|trans }}</th>
                    </tr>

                    </thead>
                    <tbody></tbody>

                </table>
                {# display navigation #}

            </div>
            <!-- end widget content -->


        </div>
        <!-- end widget div -->
    </div>

    <script type="text/javascript">

        var table;
        {% set myLocale = app.request.getLocale() %};

        function fetchData(){

            table  = $('#dt_table').DataTable({
                "columnDefs": [

                    // These are the column name variables that will be sent to the server
                    { "name": "id",   "targets": 0 },
                    { "name": "title",   "targets": 1 },
                    { "name": "type",   "targets": 2 },
                    { "name": "category",   "targets": 3 },
                    { "name": "status",   "targets": 4 },
                    { "name": "elapsed",   "targets": 5 },
                    { "name": "actions",  "targets": 6 },

                ],
                // Server-side parameters
                "processing": true,
                "serverSide": true,
                // Ajax call
                "ajax": {
                    "url": "{{ path('ticket_list_datatables') }}",
                    "type": "POST",
                    //dataType: "html"
                },
                // Classic DataTables parameters
                "paging" : true,
                "info" : true,
                "searching": true,
                "pageLength": 10,
                "order": [[1, 'asc']],
                {% if myLocale == 'es' %}
                "language": {
                    "url": "{{ asset('bundles/pizotearkadmin/js/plugin/datatables/dataTables.spanish.lang') }}"
                }
                {% else %}
                "language": {
                    "infoFiltered": ""
                }
                {% endif %}



            });

        }

        $(document).ready(function(){

            // Add a text input to each footer cell
            var pos = 1;
            $('#dt_table tfoot th').each( function () {
                var title = $(this).text();
                if(pos == 1 || pos == 2 || pos == 4 ){//columna Actions
                    $(this).html( "<input id='input" + pos + "' type='text' class='form-control' style='font-family:Arial, FontAwesome; width:50%'/>" );
                }

                pos ++;
            });


            fetchData();

            // Apply the search
            pos = 1;
            table.columns().every( function () {
                var that = this;

                $("#input"+pos).on( 'keyup change', function () {
                    if ( that.search() !== this.value )
                    {
                        that.search( this.value ).draw();
                    }
                });
                pos++;
            });


        });

    </script>




{% endblock %}


{% block extrascripts %}


    $(document).on('click', '.btn-delete', function(e){
    e.preventDefault();

    var url = $(this).attr('href');
    var c = confirm("{{ 'label_are_you_sure'|trans }}");

    if(c){
    $('#spinner').show();
    window.location = url;
    }else{
    return false;
    }


    });

{% endblock %}